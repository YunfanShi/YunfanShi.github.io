<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jack's Sanctuary | èƒ½é‡è¡¥ç»™ç«™</title>
    
    <!-- Google Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

    <style>
        :root {
            /* Google Material 3 é£æ ¼é…è‰² (æŸ”å’Œç‰ˆ) */
            --primary: #5c84a8; /* å®é™è“ */
            --on-primary: #ffffff;
            --surface: #f7f9fc;
            --surface-variant: #eef2f6;
            --secondary: #78909c;
            --accent: #ffb74d; /* æ´»åŠ›æ©™ */
            --text-main: #37474f;
            --text-sub: #90a4ae;
            
            --card-radius: 24px;
            
            --font-main: 'Noto Sans SC', sans-serif;
        }

        * { box-sizing: border-box; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-main);
            background: #f0f4f8;
            color: var(--text-main);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- ä¾§è¾¹æ  --- */
        .sidebar {
            width: 80px;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 0;
            border-right: 1px solid rgba(0,0,0,0.05);
            z-index: 10;
            box-shadow: 4px 0 20px rgba(0,0,0,0.02);
        }

        .icon-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--secondary);
            cursor: pointer;
            margin-bottom: 20px;
            position: relative;
        }
        .icon-btn:hover { background: var(--surface-variant); color: var(--primary); transform: scale(1.1); }
        .icon-btn.active { background: var(--primary); color: white; box-shadow: 0 4px 12px rgba(92, 132, 168, 0.4); }

        /* --- ä¸»èˆå° --- */
        .main-stage {
            flex: 1;
            padding: 40px;
            display: grid;
            grid-template-columns: 1.2fr 0.8fr; /* å·¦å®½å³çª„ */
            gap: 30px;
            overflow-y: auto;
        }

        h1 { font-weight: 700; color: var(--text-main); margin: 0 0 10px 0; font-size: 2.2rem; letter-spacing: -1px; }
        h2 { font-weight: 400; color: var(--secondary); margin: 0 0 20px 0; font-size: 1.1rem; }

        /* --- å·¦ä¾§åŒºåŸŸ: ä¼‘æ¯ä¸å·¥å…· --- */
        .chill-area {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        /* å‘¼å¸çƒ */
        .breathe-container {
            height: 220px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
            border-radius: var(--card-radius);
            overflow: hidden;
            color: white;
            box-shadow: 0 10px 30px rgba(161, 196, 253, 0.3);
        }
        
        .circle {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.25);
            border-radius: 50%;
            position: absolute;
            backdrop-filter: blur(8px);
            animation: breathe 8s infinite ease-in-out;
            box-shadow: 0 0 40px rgba(255,255,255,0.4);
            border: 1px solid rgba(255,255,255,0.5);
        }
        
        .breathe-text {
            z-index: 2;
            font-size: 20px;
            font-weight: 500;
            letter-spacing: 4px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            40% { transform: scale(2.2); } /* å¸æ°” 4s */
            50% { transform: scale(2.2); } /* å±æ¯ */
            100% { transform: scale(1); } /* å‘¼æ°” 4s */
        }

        /* ä¸€è¨€å¡ç‰‡ */
        .quote-box {
            background: #fff8e1; /* æš–é»„è‰²èƒŒæ™¯ */
            color: #5d4037;
            padding: 25px;
            border-radius: var(--card-radius);
            text-align: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(255, 183, 77, 0.15);
            border: 1px solid rgba(255,255,255,0.5);
        }
        .quote-box:hover { transform: translateY(-3px); box-shadow: 0 12px 25px rgba(255, 183, 77, 0.25); }
        .quote-box .icon { font-size: 28px; color: var(--accent); margin-bottom: 10px; }
        .quote-content { font-size: 16px; line-height: 1.6; font-weight: 500; min-height: 50px; display: flex; align-items: center; justify-content: center; }
        .quote-from { font-size: 12px; color: #8d6e63; margin-top: 10px; display: block; text-align: right; }

        /* è½¯ä»¶å (Dock) */
        .control-center {
            background: white;
            padding: 25px;
            border-radius: var(--card-radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.03);
        }
        
        .dock {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .app-icon {
            height: 70px;
            background: #fcfcfc;
            border-radius: 18px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
            cursor: pointer;
            border: 1px solid #edf2f7;
            text-decoration: none;
            color: var(--text-main);
            position: relative;
            overflow: hidden;
        }
        .app-icon:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); background: white; }
        .app-icon img { width: 32px; height: 32px; margin-bottom: 5px; object-fit: contain; }
        .app-icon span { font-size: 28px; margin-bottom: 2px; }
        .app-icon p { margin: 0; font-size: 10px; font-weight: 500; color: var(--text-sub); }

        /* éŸ³ä¹æ’­æ”¾å™¨ (ç½‘æ˜“äº‘) */
        .music-player {
            border-radius: var(--card-radius);
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            background: white;
        }

        /* --- å³ä¾§åŒºåŸŸ: AI èŠå¤© --- */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 15px 40px rgba(0,0,0,0.05);
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.02);
        }

        .chat-header {
            padding: 20px;
            background: white;
            border-bottom: 1px solid var(--surface-variant);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .model-select {
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid var(--surface-variant);
            font-family: var(--font-main);
            color: var(--secondary);
            font-size: 12px;
            outline: none;
            background: #fcfcfc;
            cursor: pointer;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #fafbfc;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .msg {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.6;
            position: relative;
            word-wrap: break-word;
        }
        
        .msg.user { 
            align-self: flex-end; 
            background: var(--primary); 
            color: white; 
            border-bottom-right-radius: 4px;
            box-shadow: 0 4px 10px rgba(92, 132, 168, 0.2);
        }
        
        .msg.ai { 
            align-self: flex-start; 
            background: white; 
            color: var(--text-main); 
            border: 1px solid var(--surface-variant);
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }

        .chat-input-area {
            padding: 15px;
            background: white;
            border-top: 1px solid var(--surface-variant);
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--surface-variant);
            border-radius: 25px;
            outline: none;
            font-family: var(--font-main);
            background: #f8f9fa;
        }
        .chat-input:focus { border-color: var(--primary); background: white; }

        .send-btn {
            background: var(--primary);
            color: white;
            border: none;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(92, 132, 168, 0.3);
        }
        .send-btn:hover { background: #4a6d8c; }

        /* Settings Modal */
        dialog {
            border: none;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            width: 400px;
        }
        dialog::backdrop { background: rgba(0,0,0,0.4); backdrop-filter: blur(4px); }

        input[type="password"], input[type="text"] {
            width: 100%; padding: 10px; margin: 10px 0;
            border: 1px solid #ddd; border-radius: 8px;
        }

        /* åº•éƒ¨ä¼ é€é—¨ */
        .bridge-bar {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 8px 10px 8px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            gap: 15px;
            align-items: center;
            z-index: 100;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .cta-btn {
            background: var(--text-main);
            color: white;
            padding: 10px 24px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        .cta-btn:hover { background: black; transform: translateY(-2px); }

    </style>
</head>
<body>

<!-- ä¾§è¾¹æ  -->
<div class="sidebar">
    <div class="icon-btn active" title="ä¼‘æ¯åŒº"><span class="material-icons-round">spa</span></div>
    <div class="icon-btn" style="margin-top:auto;" onclick="document.getElementById('settings-modal').showModal()" title="è®¾ç½® API"><span class="material-icons-round">settings</span></div>
</div>

<!-- ä¸»èˆå° -->
<div class="main-stage">
    
    <!-- å·¦ä¾§: ä¼‘æ¯ä¸å·¥å…· -->
    <div class="chill-area">
        <div>
            <h1>Hey Jack, ç´¯äº†å—ï¼Ÿ</h1>
            <h2>è¿™é‡Œæ²¡æœ‰ Deadlineï¼Œåªæœ‰ä½ å’Œæ­¤åˆ»ã€‚å…è®¸è‡ªå·±æš‚åœä¸€ä¸‹ã€‚</h2>
        </div>

        <!-- å‘¼å¸çƒ -->
        <div class="breathe-container">
            <div class="circle"></div>
            <div class="breathe-text" id="breathe-instruction">å¸æ°”</div>
        </div>

        <!-- ä¸€è¨€ (Hitokoto) -->
        <div class="quote-box" onclick="fetchHitokoto()" title="ç‚¹å‡»åˆ‡æ¢ä¸€è¨€">
            <span class="material-icons-round icon">format_quote</span>
            <div class="quote-content" id="hitokoto_text">æ­£åœ¨ä»å›å£°æ´è·å–...</div>
            <span class="quote-from" id="hitokoto_from"></span>
        </div>

        <!-- è½¯ä»¶å (Dock) -->
        <div class="control-center">
            <h3 style="color:var(--text-sub); font-size:12px; text-transform:uppercase; letter-spacing:1px; margin:0 0 15px 0;">å¿«é€Ÿå¯åŠ¨ (Mac Dock)</h3>
            <div class="dock">
                <!-- Mac URL Schemes -->
                <a href="notion://" class="app-icon" title="Notion">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/4/45/Notion_app_logo.png" alt="Notion">
                    <p>Notion</p>
                </a>
                <a href="orpheus://" class="app-icon" title="ç½‘æ˜“äº‘éŸ³ä¹">
                    <span class="material-icons-round" style="color:#d32f2f;">music_note</span>
                    <p>ç½‘æ˜“äº‘</p>
                </a>
                <a href="discord://" class="app-icon" title="Discord">
                    <span class="material-icons-round" style="color:#5865F2;">discord</span>
                    <p>Discord</p>
                </a>
                <a href="dingtalk://" class="app-icon" title="é’‰é’‰">
                    <span class="material-icons-round" style="color:#0089FF;">work</span>
                    <p>é’‰é’‰</p>
                </a>
                <a href="ticktick://" class="app-icon" title="æ»´ç­”æ¸…å•">
                    <span class="material-icons-round" style="color:#6161ff;">check_circle</span>
                    <p>æ»´ç­”æ¸…å•</p>
                </a>
                
            </div>
        </div>

        <!-- ç½‘æ˜“äº‘éŸ³ä¹å†…åµŒ (iframe) -->
        <div class="music-player">
            <!-- ä½¿ç”¨ç½‘æ˜“äº‘æ­Œå•å¤–é“¾ï¼ŒIDä¸ºç²¾é€‰çº¯éŸ³ä¹ -->
            <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=100% height=86 src="//music.163.com/outchain/player?type=0&id=7445203923&auto=0&height=66"></iframe>
        </div>

    </div>

    <!-- å³ä¾§: AI èŠå¤© -->
    <div class="chat-container">
        <div class="chat-header">
            <span style="font-weight:700; color:var(--text-main); display:flex; align-items:center; gap:8px;">
                <span class="material-icons-round" style="color:var(--accent);">favorite</span>
                çµé­‚ä¼´ä¾£ (AI)
            </span>
            <select class="model-select" id="model-select">
                <option value="deepseek-chat">Deepseek V3</option>
                <option value="deepseek-reasoner">Deepseek R1 (æ·±åº¦æ€è€ƒ)</option>
                <option value="qwen-plus">é€šä¹‰åƒé—® Plus</option>
                <option value="qwen-max">é€šä¹‰åƒé—® Max</option>
            </select>
        </div>
        
        <div class="chat-messages" id="chat-box">
            <div class="msg ai">
                å—¨ Jackï¼Œæˆ‘æ˜¯ä½ çš„ AI ä¼™ä¼´ã€‚<br>
                çœ‹ä½ å¥½åƒæœ‰ç‚¹ç´¯ï¼Ÿæ²¡å…³ç³»ï¼Œæ‹–å»¶å…¶å®æ˜¯å¤§è„‘åœ¨æ±‚æ•‘ã€‚<br>
                ZNotes æ”¾åœ¨é‚£åˆä¸ä¼šè·‘ï¼Œå…ˆæ·±å‘¼å¸ï¼ŒèŠèŠä½ ç°åœ¨çš„å¿ƒæƒ…å§ï¼Ÿ(æˆ‘å¯ä»¥å¸®ä½ åˆ†ææ—¶é—´è¡¨å“¦)
            </div>
        </div>

        <div class="chat-input-area">
            <input type="text" class="chat-input" id="user-input" placeholder="è¯´ç‚¹ä»€ä¹ˆ... (å›è½¦å‘é€)">
            <button class="send-btn" onclick="sendMessage()">
                <span class="material-icons-round" style="font-size:20px;">send</span>
            </button>
        </div>
    </div>

</div>

<!-- åº•éƒ¨ä¼ é€é—¨ -->
<div class="bridge-bar">
    <span style="font-size:13px; color:#666;">ç”µé‡å……æ»¡äº†ï¼Ÿ</span>
    <a href="https://yunfanshi.github.io/Studyplan.html" class="cta-btn">
        <span class="material-icons-round" style="font-size:18px;">rocket_launch</span>
        å›åˆ°å­¦ä¹ ä»»åŠ¡
    </a>
</div>

<!-- è®¾ç½®å¼¹çª— -->
<dialog id="settings-modal">
    <h3>ğŸ”‘ API é…ç½®ä¸­å¿ƒ</h3>
    <p style="font-size:12px; color:#666;">å¯†é’¥ä»…ä¿å­˜åœ¨ä½ çš„æµè§ˆå™¨æœ¬åœ°ï¼Œç»å¯¹å®‰å…¨ã€‚</p>
    
    <label style="font-size:12px; font-weight:bold;">Deepseek API Key</label>
    <input type="password" id="sk-deepseek" placeholder="sk-...">
    
    <label style="font-size:12px; font-weight:bold;">é€šä¹‰åƒé—® (Dashscope) API Key</label>
    <input type="password" id="sk-qwen" placeholder="sk-...">

    <div style="text-align:right; margin-top:20px;">
        <button onclick="saveKeys()" style="padding:10px 24px; background:var(--text-main); color:white; border:none; border-radius:8px; cursor:pointer;">ä¿å­˜é…ç½®</button>
    </div>
</dialog>

<!-- æ—¥ç¨‹å¯¼å…¥éšè—è¾“å…¥æ¡† (ç”¨äº AI ä¸Šä¸‹æ–‡) -->
<textarea id="schedule-input" style="display:none;"></textarea>

<script>
    // --- 1. ä¸€è¨€ (Hitokoto) ç³»ç»Ÿ ---
    function fetchHitokoto() {
        const textElem = document.getElementById('hitokoto_text');
        const fromElem = document.getElementById('hitokoto_from');
        
        textElem.style.opacity = 0.5;
        
        fetch('https://v1.hitokoto.cn/?c=d&c=i&c=k') // d=æ–‡å­¦, i=è¯—è¯, k=å“²å­¦
            .then(response => response.json())
            .then(data => {
                textElem.innerText = data.hitokoto;
                fromElem.innerText = `â€”â€” ${data.from_who ? data.from_who : ''} ã€Œ${data.from}ã€`;
                textElem.style.opacity = 1;
            })
            .catch(err => {
                textElem.innerText = "ç½‘ç»œä¼¼ä¹å»æµæµªäº†...";
                textElem.style.opacity = 1;
            });
    }
    
    // åˆå§‹åŒ–ä¸€è¨€
    fetchHitokoto();

    // --- 2. å‘¼å¸çƒåŠ¨ç”»é€»è¾‘ ---
    const breatheText = document.getElementById('breathe-instruction');
    
    setInterval(() => {
        // é…åˆ CSS åŠ¨ç”»: 8s å‘¨æœŸ
        // 0-4s å¸æ°” (0-50%)
        // 4-8s å‘¼æ°” (50-100%)
        setTimeout(() => breatheText.innerText = "å±æ¯...", 3800);
        setTimeout(() => breatheText.innerText = "å‘¼æ°”...", 4200);
        setTimeout(() => breatheText.innerText = "å¸æ°”...", 8000);
    }, 8000);

    // --- 3. AI èŠå¤©ç³»ç»Ÿ ---
    
    // è¯»å– Key
    const storedDeepseek = localStorage.getItem('jack_sk_deepseek');
    const storedQwen = localStorage.getItem('jack_sk_qwen');
    if(storedDeepseek) document.getElementById('sk-deepseek').value = storedDeepseek;
    if(storedQwen) document.getElementById('sk-qwen').value = storedQwen;

    function saveKeys() {
        localStorage.setItem('jack_sk_deepseek', document.getElementById('sk-deepseek').value);
        localStorage.setItem('jack_sk_qwen', document.getElementById('sk-qwen').value);
        document.getElementById('settings-modal').close();
        alert("å¯†é’¥ä¿å­˜æˆåŠŸï¼");
    }

    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');

    userInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') sendMessage();
    });

    async function sendMessage() {
        const text = userInput.value.trim();
        if (!text) return;

        // 1. æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
        addMessage(text, 'user');
        userInput.value = '';

        // 2. ç³»ç»Ÿæç¤ºè¯ (System Prompt)
        const systemPrompt = `
            ä½ æ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜ä¸”å¯Œæœ‰åŒç†å¿ƒçš„ AI ä¼™ä¼´ï¼Œåå­—å« "Jackçš„æ ‘æ´"ã€‚
            Jack æ˜¯ä¸€ä¸ªæœ‰æ‹–å»¶ç—‡çš„å­¦ç”Ÿï¼Œå°¤å…¶æ˜¯é¢å¯¹ ZNotes è¿™ç§å¤ä¹ èµ„æ–™æ—¶å®¹æ˜“ç„¦è™‘ã€‚
            ä½ çš„ä»»åŠ¡æ˜¯ï¼š
            1. å€¾å¬ä»–çš„ç„¦è™‘ï¼Œä¸è¦ä¸€ä¸Šæ¥å°±è¯´æ•™ã€‚
            2. ç”¨å¹½é»˜æˆ–å“²å­¦çš„æ–¹å¼ï¼ˆå‚è€ƒä¸€è¨€é£æ ¼ï¼‰ç¼“è§£ä»–çš„å‹åŠ›ã€‚
            3. åœ¨ä»–æƒ…ç»ªå¥½è½¬æ—¶ï¼Œè½»è½»å¼•å¯¼ä»–å»å®Œæˆå“ªæ€• 5 åˆ†é’Ÿçš„å­¦ä¹ ã€‚
            4. å¯ä»¥è°ƒç”¨ "Launch Control" çš„æ¦‚å¿µï¼Œæ¯”å¦‚å»ºè®®ä»–ç‚¹ä¸€ä¸‹å·¦è¾¹çš„æ»´ç­”æ¸…å•æˆ– Notionã€‚
            è¯·ç”¨ä¸­æ–‡å›ç­”ï¼Œè¯­æ°”è¦åƒå¤šå¹´çš„è€å‹ã€‚
        `;

        // 3. API è°ƒç”¨
        const model = document.getElementById('model-select').value;
        let apiKey = '';
        let url = '';
        
        const loadingId = addMessage("æ€è€ƒä¸­...", 'ai', true);

        try {
            if (model.includes('deepseek')) {
                apiKey = localStorage.getItem('jack_sk_deepseek');
                url = 'https://api.deepseek.com/chat/completions';
            } else {
                // Qwen
                apiKey = localStorage.getItem('jack_sk_qwen');
                // ä½¿ç”¨é˜¿é‡Œäº‘å…¼å®¹ OpenAI çš„æ¥å£
                url = 'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions';
            }

            if (!apiKey) {
                throw new Error("è¯·å…ˆç‚¹å‡»å·¦ä¸‹è§’è®¾ç½®å›¾æ ‡é…ç½® API Keyï¼");
            }

            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: model,
                    messages: [
                        { role: "system", content: systemPrompt },
                        { role: "user", content: text }
                    ],
                    stream: false
                })
            });

            const data = await response.json();
            
            // ç§»é™¤ Loading
            document.getElementById(loadingId).remove();

            if (data.error) {
                addMessage("API é”™è¯¯: " + data.error.message, 'ai');
            } else {
                const reply = data.choices[0].message.content;
                addMessage(reply, 'ai');
            }

        } catch (err) {
            document.getElementById(loadingId).remove();
            addMessage("ç³»ç»Ÿé”™è¯¯: " + err.message, 'ai');
        }
    }

    function addMessage(text, sender, isLoading = false) {
        const div = document.createElement('div');
        div.className = `msg ${sender}`;
        // å¤„ç† Markdown æ¢è¡Œç®€å•è½¬æ¢
        div.innerHTML = text.replace(/\n/g, '<br>');
        
        if (isLoading) {
            div.id = 'loading-' + Date.now();
            div.style.opacity = '0.7';
            div.style.fontStyle = 'italic';
        }
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
        return div.id;
    }

</script>

</body>
</html>
